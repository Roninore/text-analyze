!function(){var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var t=Array.isArray,r="object"==typeof e&&e&&e.Object===Object&&e,n="object"==typeof self&&self&&self.Object===Object&&self,i=r||n||Function("return this")(),s=i.Symbol,a=Object.prototype,o=a.hasOwnProperty,c=a.toString,l=s?s.toStringTag:void 0;var d=function(e){var t=o.call(e,l),r=e[l];try{e[l]=void 0;var n=!0}catch(e){}var i=c.call(e);return n&&(t?e[l]=r:delete e[l]),i},u=Object.prototype.toString;var h=function(e){return u.call(e)},f=s?s.toStringTag:void 0;var p=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":f&&f in Object(e)?d(e):h(e)};var v=function(e){return null!=e&&"object"==typeof e};var m=function(e){return"symbol"==typeof e||v(e)&&"[object Symbol]"==p(e)},y=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,g=/^\w*$/;var b=function(e,r){if(t(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!m(e))||(g.test(e)||!y.test(e)||null!=r&&e in Object(r))};var E=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)};var w,T=function(e){if(!E(e))return!1;var t=p(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},_=i["__core-js_shared__"],P=(w=/[^.]+$/.exec(_&&_.keys&&_.keys.IE_PROTO||""))?"Symbol(src)_1."+w:"";var O=function(e){return!!P&&P in e},k=Function.prototype.toString;var I=function(e){if(null!=e){try{return k.call(e)}catch(e){}try{return e+""}catch(e){}}return""},S=/^\[object .+?Constructor\]$/,L=Function.prototype,C=Object.prototype,A=L.toString,j=C.hasOwnProperty,B=RegExp("^"+A.call(j).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var N=function(e){return!(!E(e)||O(e))&&(T(e)?B:S).test(I(e))};var R=function(e,t){return null==e?void 0:e[t]};var M=function(e,t){var r=R(e,t);return N(r)?r:void 0},H=M(Object,"create");var D=function(){this.__data__=H?H(null):{},this.size=0};var F=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},q=Object.prototype.hasOwnProperty;var z=function(e){var t=this.__data__;if(H){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return q.call(t,e)?t[e]:void 0},x=Object.prototype.hasOwnProperty;var V=function(e){var t=this.__data__;return H?void 0!==t[e]:x.call(t,e)};var $=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=H&&void 0===t?"__lodash_hash_undefined__":t,this};function U(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}U.prototype.clear=D,U.prototype.delete=F,U.prototype.get=z,U.prototype.has=V,U.prototype.set=$;var G=U;var K=function(){this.__data__=[],this.size=0};var W=function(e,t){return e===t||e!=e&&t!=t};var Y=function(e,t){for(var r=e.length;r--;)if(W(e[r][0],t))return r;return-1},X=Array.prototype.splice;var J=function(e){var t=this.__data__,r=Y(t,e);return!(r<0)&&(r==t.length-1?t.pop():X.call(t,r,1),--this.size,!0)};var Q=function(e){var t=this.__data__,r=Y(t,e);return r<0?void 0:t[r][1]};var Z=function(e){return Y(this.__data__,e)>-1};var ee=function(e,t){var r=this.__data__,n=Y(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function te(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}te.prototype.clear=K,te.prototype.delete=J,te.prototype.get=Q,te.prototype.has=Z,te.prototype.set=ee;var re=te,ne=M(i,"Map");var ie=function(){this.size=0,this.__data__={hash:new G,map:new(ne||re),string:new G}};var se=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var ae=function(e,t){var r=e.__data__;return se(t)?r["string"==typeof t?"string":"hash"]:r.map};var oe=function(e){var t=ae(this,e).delete(e);return this.size-=t?1:0,t};var ce=function(e){return ae(this,e).get(e)};var le=function(e){return ae(this,e).has(e)};var de=function(e,t){var r=ae(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function ue(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ue.prototype.clear=ie,ue.prototype.delete=oe,ue.prototype.get=ce,ue.prototype.has=le,ue.prototype.set=de;var he=ue;function fe(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,i=t?t.apply(this,n):n[0],s=r.cache;if(s.has(i))return s.get(i);var a=e.apply(this,n);return r.cache=s.set(i,a)||s,a};return r.cache=new(fe.Cache||he),r}fe.Cache=he;var pe=fe;var ve=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,me=/\\(\\)?/g,ye=function(e){var t=pe(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(ve,(function(e,r,n,i){t.push(n?i.replace(me,"$1"):r||e)})),t}));var ge=function(e,t){for(var r=-1,n=null==e?0:e.length,i=Array(n);++r<n;)i[r]=t(e[r],r,e);return i},be=s?s.prototype:void 0,Ee=be?be.toString:void 0;var we=function e(r){if("string"==typeof r)return r;if(t(r))return ge(r,e)+"";if(m(r))return Ee?Ee.call(r):"";var n=r+"";return"0"==n&&1/r==-Infinity?"-0":n};var Te=function(e){return null==e?"":we(e)};var _e=function(e,r){return t(e)?e:b(e,r)?[e]:ye(Te(e))};var Pe=function(e){if("string"==typeof e||m(e))return e;var t=e+"";return"0"==t&&1/e==-Infinity?"-0":t};var Oe=function(e,t){for(var r=0,n=(t=_e(t,e)).length;null!=e&&r<n;)e=e[Pe(t[r++])];return r&&r==n?e:void 0};var ke,Ie,Se=function(e,t,r){var n=null==e?void 0:Oe(e,t);return void 0===n?r:n},Le=(function(e,t){function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n,i,s=r(Se);t.PerformanceEntryType=void 0,(n=t.PerformanceEntryType||(t.PerformanceEntryType={})).MARK="mark",n.MEASURE="measure",n.NAVIGATION="navigation",n.RESOURCE="resource",n.LONGTASK="longtask",n.PAINT="paint",n.ELEMENT="element",n.EVENT="event",n.FID="first-input",n.CLS="layout-shift",n.LCP="largest-contentful-paint",function(e){e.NAVIGATION="navigation",e.CSS="css",e.SCRIPT="script",e.XHR="xmlhttprequest",e.FETCH="fetch",e.BEACON="beacon",e.VIDEO="video",e.AUDIO="audio",e.TRACK="track",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.A="a",e.IFRAME="iframe",e.FRAME="frame",e.OTHER="other"}(i||(i={}));var a,o=Object.freeze({__proto__:null,get PerformanceEntryInitiatorType(){return i},get PerformanceEntryType(){return t.PerformanceEntryType}});function c(e,t){return new Promise((r=>setTimeout((()=>r(t)),e)))}function l(e){const t=e&&e.serverTiming,r=t&&t.find((({name:e})=>"RequestID"===e));return r&&r.description||""}async function d(e,t=50,r=10){for(;!e()&&r>0;)await c(t),r-=1;return!0}async function u(){const e=await navigator.permissions.query({name:"notifications"});return"denied"===Notification.permission&&"prompt"===e.state}async function h(e){if(!navigator.permissions)return!1;try{return e?await async function(){return Promise.race([u(),c(100,!0)])}():await u()}catch(e){}return!1}!function(e){e.WEBDRIVER="webdriver",e.HEADLESS="headless"}(a||(a={}));const f=async({needDetectHeadless:e})=>{let t="";return await h(e)?t=a.HEADLESS:window.navigator.webdriver&&(t=a.WEBDRIVER),t},p=async()=>{if(navigator.getBattery)return navigator.getBattery().then((({level:e})=>e)).catch((()=>{}))},v=async({needDetectHeadless:e})=>{const[t,r]=await Promise.all([f({needDetectHeadless:e}),p()]);return{...t?{testingToolName:t}:{},screenResolutionX:s.default(window,"screen.width"),screenResolutionY:s.default(window,"screen.height"),screenPixelDensity:s.default(window,"devicePixelRatio"),effectiveConnectionType:s.default(window,"navigator.connection.effectiveType"),referrer:s.default(window,"document.referrer"),deviceRam:s.default(window,"navigator.deviceMemory"),deviceCores:s.default(window,"navigator.hardwareConcurrency"),downlink:s.default(window,"navigator.connection.downlink"),roundTripTime:s.default(window,"navigator.connection.rtt"),deviceBattery:r}},m={fonts_loaded:"fontsLoaded",css_parsed:"cssParsed",head_html_parsed:"headHtmlParsed",body_html_parsed:"bodyHtmlParsed",HYDRATION_TIME:"appInitEnd",html_head_start:"htmlHeadStart",image_preloaded:"imagePreloaded",link_preloaded:"linkPreloaded",meta_loaded:"metaLoaded",link_preconnected:"linkPreconnected"},y=()=>{const e={bodyHtmlParsed:0,cssParsed:0,fontsLoaded:0,headHtmlParsed:0,appInitEnd:0,htmlHeadStart:0,imagePreloaded:0,linkPreloaded:0,metaLoaded:0,linkPreconnected:0};for(const[t,r]of Object.entries(m)){const n=performance.getEntriesByName(t)[0];n&&(e[r]=n.startTime)}const t=e.linkPreloaded||e.imagePreloaded;return e.linkPreloaded=t,e.imagePreloaded=t,e},g=()=>{return(e=t.PerformanceEntryType.NAVIGATION,performance.getEntriesByType(e))[0]||{};var e};class b{observer;entries=[];constructor(){this.observer=new PerformanceObserver((e=>{this.entries=e.getEntries(),this.observer.disconnect()})),this.observer.observe({type:"element",buffered:!0})}async collectData(){return document&&document.querySelectorAll("[elementtiming]").length?(await d((()=>this.entries.length>0)),this.entries.length?this.entries.slice(0,5).map((e=>{const t=e.identifier.replace("lcp_eltiming_",""),r=performance.getEntriesByName("lcp_script_"+t)[0];return{name:t,loadTime:e.loadTime,renderTime:e.renderTime,scriptTiming:r&&r.startTime,networkTiming:performance.getEntriesByName(e.url)[0]}})):[]):[]}}class E{config;vitalsObserver;constructor(e,t){this.config=e,this.vitalsObserver=t}async createCommonBlocks(){return{browser:await v(this.config)}}async createHtmlEvent(e){const{trackPerformanceMarks:t,trackLcpAspects:r,htmlRequestId:n}={...this.config,...e},i=await this.vitalsObserver.getWebVitals(r);let s={},a={};if(t){const e=new b;s={performanceMarks:y()},a={elements:await e.collectData()}}return{...await this.createCommonBlocks(),htmlEvent:{requestId:n,navigationTiming:g(),webVitals:i,...s,...a}}}async createImagesEvent(e){return{...await this.createCommonBlocks(),htmlEvent:{requestId:this.config.htmlRequestId,assets:{images:e.map((e=>({networkTiming:e})))}}}}async createScriptsEvent(e){return{...await this.createCommonBlocks(),htmlEvent:{requestId:this.config.htmlRequestId,assets:{scripts:e.map((e=>({networkTiming:e})))}}}}async createPaginationEvent(e){return{...await this.createCommonBlocks(),paginationEvents:e}}}var w;!function(e){e.START="start",e.END="end"}(w||(w={}));class T{heldEntries=[];sentEntries=[];capacity=20;constructor(e){this.capacity=void 0!==e.capacity?e.capacity:20}addHeldEntries(e,t=w.END){"start"===t?this.heldEntries.unshift(...e):this.heldEntries.push(...e)}addSentEntries(e){this.sentEntries.push(...e)}deleteHeldEntry(e){return"object"==typeof this.heldEntries[e]&&(this.heldEntries.splice(e,1),!0)}clearHeldEntries(){this.heldEntries=[]}clearSentEntries(){this.sentEntries=[]}isFull(){return this.heldEntries.length>=this.capacity}}const _={pageCloseEnabled:!0,capacity:20,sendTimeout:3e4,sendMethod:()=>Promise.resolve(!1)};class P{store;config;scheduledSendTimer;isOnUnload=!1;constructor(e){this.add=this.add.bind(this),this.config=Object.assign({},e),this.store=new T({capacity:this.config.capacity}),this.scheduledSendTimer=((e,t)=>{let r;const n={start(){n.cancel(),r=window.setTimeout(e,t)},cancel(){window.clearTimeout(r),r=void 0}};return n})((()=>this.send()),this.config.sendTimeout||e.sendTimeout||_.sendTimeout),setTimeout((()=>{(e=>{const t=()=>{"hidden"===document.visibilityState&&(e(),window.removeEventListener("visibilitychange",t))};window.addEventListener("visibilitychange",t),window.addEventListener("beforeunload",(()=>e()))})(this.flush.bind(this))}))}add(e,{forceSend:t=!1}={}){if(this.isOnUnload)return this.scheduledSendTimer.cancel(),void this.store.addHeldEntries([e]);this.store.addHeldEntries([e]),this.store.isFull()||t?this.flush():this.scheduledSendTimer.start()}flush(){this.scheduledSendTimer.cancel(),this.send()}async send(){const e=this.store.heldEntries.slice();e.length&&(this.config.sendMethod(e),this.store.clearHeldEntries(),this.store.addSentEntries(e))}}class O{observer;entriesBuffer;constructor(e){this.entriesBuffer=new P({..._,sendMethod:e}),this.observer=new PerformanceObserver(this.collectEntries),document.addEventListener("pagehide",this.stopCollectEntries)}collectEntries=e=>{e.getEntries().filter((e=>e.initiatorType===i.IMG||e.initiatorType===i.CSS&&/.(jpe?g|png|webp)/i.test(e.name))).forEach((e=>{e.decodedBodySize>0&&this.entriesBuffer.add(e)}))};startCollectEntries(){this.observer.observe({type:"resource",buffered:!0})}stopCollectEntries=()=>{this.observer.disconnect()}}class k{observer;buffer;constructor(e){this.observer=new PerformanceObserver(this.collectScripts),this.buffer=new P({..._,sendMethod:e}),document.addEventListener("pagehide",this.stopCollectEntries)}startCollectEntries(){this.observer.observe({type:"resource",buffered:!0})}stopCollectEntries=()=>{this.observer.disconnect()};collectScripts=e=>{const t=e.getEntries();for(const e of t)/\.js$/.test(e.name)&&e.decodedBodySize>0&&this.buffer.add(e)}}class I{observer;entriesBuffer;entryList=[];constructor(e){this.entriesBuffer=new P({..._,sendTimeout:5e3,sendMethod:e}),this.observer=new PerformanceObserver(this.collectMarks),document.addEventListener("pagehide",this.stopCollectMarks)}collectMarks=e=>{const t=e.getEntries();this.entryList=this.entryList.concat(t),t.filter((e=>"paginationEnd"===e.name)).forEach((e=>{const t=this.createPaginationEvent(e);t&&this.entriesBuffer.add(t)}))};createPaginationEvent(e){const t=e.startTime,r=s.default(e,"detail.queryUrl","");if(r){const e=this.entryList.filter((e=>"paginationStart"===e.name)).find((({detail:e})=>s.default(e,"queryUrl")===r)),n=s.default(e,"startTime"),i=s.default(e,"detail");if(n)return this.createPaginationEntry(r,n,t,i)}}createPaginationEntry(e,r,n,a){const o=performance.getEntriesByType(t.PerformanceEntryType.RESOURCE).find((t=>t.initiatorType===i.FETCH&&t.name.includes(e)));if(o)return{requestId:l(o),layoutContainer:s.default(a,"layoutContainer",""),stateId:s.default(a,"stateId",""),index:s.default(a,"index",-1),totalTime:n-r,networkTiming:o}}startCollectMarks(){this.observer.observe({type:"mark",buffered:!0})}stopCollectMarks=()=>{this.observer.disconnect()}}const S=e=>s.default(e,"renderTime")||s.default(e,"loadTime"),L=e=>{if(!e)return[];const t=[];let r=e;for(;r.parentNode&&"BODY"!==r.nodeName;){const e=r.getAttribute("data-widget");e&&t.push(e),r=r.parentNode}return t};class C{LCP={entries:[]};CLS={entries:[]};FID={entries:[]};LT={entries:[]};clsObserver;lcpObserver;fidObserver;ltObserver;navTotalTime=0;lastLcpEntry=void 0;constructor(){this.lcpObserver=new PerformanceObserver((e=>{this.collectEntries(e,"LCP")})),this.clsObserver=new PerformanceObserver((e=>{this.collectEntries(e,"CLS")})),this.fidObserver=new PerformanceObserver((e=>{this.collectEntries(e,"FID")})),this.ltObserver=new PerformanceObserver((e=>{this.collectEntries(e,"LT")})),this.lcpObserver.observe({type:t.PerformanceEntryType.LCP,buffered:!0}),this.clsObserver.observe({type:t.PerformanceEntryType.CLS,buffered:!0}),this.fidObserver.observe({type:t.PerformanceEntryType.FID,buffered:!0}),this.ltObserver.observe({type:t.PerformanceEntryType.LONGTASK,buffered:!0})}stopCollecting(){this.lcpObserver.disconnect(),this.clsObserver.disconnect(),this.fidObserver.disconnect(),this.ltObserver.disconnect()}collectEntries(e,t){const r=e.getEntries();for(const e of r)this[t].entries.push(e)}calculateLCP(){const e=this.LCP.entries.filter((e=>S(e)<=this.navTotalTime));return this.lastLcpEntry=e[e.length-1],this.lastLcpEntry?S(this.lastLcpEntry):0}async calculateLcpAspects(){const e=s.default(this.lastLcpEntry,"element"),t=s.default(e,"localName",""),r=s.default(e,"currentSrc","");await d((()=>performance.getEntriesByName(r).length>0));const n=r?{networkTiming:performance.getEntriesByName(r)[0]}:{};return{loadTime:s.default(this.lastLcpEntry,"loadTime",0),renderTime:s.default(this.lastLcpEntry,"renderTime",0),widgets:e?L(e):[],size:s.default(this.lastLcpEntry,"size",0),...n,tag:t,url:r}}calculateCLS(){return this.CLS.entries.reduce(((e,t)=>t.startTime<=this.navTotalTime&&!t.hadRecentInput?e+t.value:e),0)}calculateFID(){const e=this.FID.entries[0];return e?e.processingStart-e.startTime:0}calculateLT(){return this.LT.entries.length}async getWebVitals(e){this.stopCollecting();const r=performance.getEntriesByType(t.PerformanceEntryType.NAVIGATION)[0];this.navTotalTime=r.loadEventEnd;const n={cls:this.calculateCLS(),lcp:this.calculateLCP(),fid:this.calculateFID(),lt:this.calculateLT()};return e&&(n.lcpAspects=await this.calculateLcpAspects()),n}}t.PerformanceTracker=class{config;builder;imagesObserver;scriptsObserver;paginationObserver;vitalsObserver;constructor(e){this.config=e,this.vitalsObserver=new C,this.builder=new E(this.config,this.vitalsObserver);const t=this.sendImages.bind(this),r=this.sendScripts.bind(this),n=this.sendPagination.bind(this);e.trackImages&&(this.imagesObserver=new O(t),this.imagesObserver.startCollectEntries()),e.trackScripts&&(this.scriptsObserver=new k(r),this.scriptsObserver.startCollectEntries()),e.trackPagination&&(this.paginationObserver=new I(n),this.paginationObserver.startCollectMarks())}async onLoad(){this.vitalsObserver.stopCollecting();const e=await this.builder.createHtmlEvent({});return this.send(e)}async onBeforeUnload(){const e={trackPerformanceMarks:void 0,trackLcpAspects:void 0},t=await this.builder.createHtmlEvent(e);return this.send(t)}async sendImages(e){const t=await this.builder.createImagesEvent(e);return this.send(t)}async sendScripts(e){const t=await this.builder.createScriptsEvent(e);return this.send(t)}async sendPagination(e){const t=await this.builder.createPaginationEvent(e);return this.send(t)}send(e){const t=JSON.stringify(e);return navigator.sendBeacon(this.config.endpoint,t)}},t.Types=o,t.extractRequestId=l,t.getBrowser=v,t.getNavigationTimings=g,t.sleep=c,t.waitFor=d}(ke={exports:{}},ke.exports),ke.exports);(Ie=Le)&&Ie.__esModule&&Object.prototype.hasOwnProperty.call(Ie,"default")&&Ie.default,Le.PerformanceEntryType;var Ce=Le.PerformanceTracker;Le.Types;var Ae=Le.extractRequestId;Le.getBrowser;var je=Le.getNavigationTimings;Le.sleep,Le.waitFor;const Be=()=>{const e=je();return Ae(e)};class Ne{tracker;constructor(){const{requestId:e,endpoint:t,trackImages:r,trackScripts:n,detectHeadless:i,pageViewId:s,trackLcpAspects:a,trackPerformanceMarks:o,trackPagination:c}=(()=>{const e=Se(window,"__cpmInit__");return{trackImages:Se(e,"trackImages"),trackScripts:Se(e,"trackScripts"),detectHeadless:Se(e,"detectHeadless"),trackLcpAspects:Se(e,"trackLcpAspects"),trackPerformanceMarks:Se(e,"trackPerformanceMarks"),trackPagination:!0,requestId:Be(),endpoint:`${Se(e,"basePath")}/perf-metrics-collector/v4/rum/bx/web`,pageViewId:Se(window,"$tracker.pageViewId")}})();this.tracker=new Ce({endpoint:t,htmlRequestId:e,trackImages:r,trackScripts:n,needDetectHeadless:i,pageViewId:s,trackLcpAspects:a||o,trackPerformanceMarks:o,trackPagination:c});const l=()=>{this.tracker.onBeforeUnload()},d=async()=>{await this.tracker.onLoad()&&window.removeEventListener("beforeunload",l)};window.addEventListener("beforeunload",l),"complete"===document.readyState?setTimeout(d,0):window.addEventListener("load",(()=>setTimeout(d,0)))}trackPagination(){}}if(window.PerformanceObserver)try{window.$perfTracker=new Ne}catch{}}();
